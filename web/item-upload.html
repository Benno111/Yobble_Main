<!DOCTYPE html>
<html><head>
<meta charset="UTF-8">
<title>Upload Item - Yobble</title>
<link rel="stylesheet" href="/style.css">
</head>
<body>
<main class="card" style="max-width:500px">
<h1>Upload Item</h1>
<label>Item Code</label><input id="code">
<label>Name</label><input id="name">
<label>Description</label><textarea id="desc"></textarea>
<label>Icon</label><input type="file" id="icon">
<button id="upload" class="primary">Submit for review</button>
<div id="status" class="muted"></div>
</main>
<script type="module">
import { requireAuth } from "/js/auth.js";
await requireAuth();
upload.onclick = async ()=>{
  const fd=new FormData();
  fd.append("code",code.value.trim());
  fd.append("name",name.value.trim());
  fd.append("description",desc.value.trim());
  if(icon.files[0]) fd.append("icon",icon.files[0]);
  status.textContent="Uploadingâ€¦";
  const r=await fetch("/api/items/upload",{
    method:"POST",
    headers:{Authorization:"Bearer "+localStorage.token},
    body:fd
  });
  const j=await r.json();
  status.textContent=j.ok?"Submitted for moderation":"Error: "+j.error;
};
</script>
<script type="module" src="/js/pages/item-upload.js"></script>
</body></html>
